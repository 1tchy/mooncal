@(messages: play.i18n.Messages, request: play.mvc.Http.Request)
<img src="/images/mond.png" alt='@messages.at("app.moon")' id="mond"/>
<h1 ng-init="lang='@messages.at("lang.current")'">@messages.at("app.title")</h1>

<p>@messages.at("app.introduction")</p>

<div class="row">
	<div class="col-md-6">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">@messages.at("phases.title")</h3>
			</div>
			<div class="panel-body">
				@for(phase <- Array("phases.full","phases.new","phases.quarter","phases.daily")) {
				<div class="checkbox">
					<label>
						<input type="checkbox" ng-model="@{phase}.value"/> @messages.at(phase)
					</label>
				</div>
				}
			</div>
		</div>
	</div>
	<div class="col-md-6">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">@messages.at("events.title")</h3>
			</div>
			<div class="panel-body">
				@for(event <- Array("events.lunareclipse","events.solareclipse","events.moonlanding")) {
				<div class="checkbox">
					<label>
						<input type="checkbox" ng-model="@{event}.value"/> @messages.at(event)
					</label>
				</div>
				}
			</div>
		</div>
	</div>
</div>

<div class="row">
	<div class="col-md-12">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">@messages.at("time.title")</h3>
			</div>
			<div class="panel-body">
				<form class="form-inline" name="fromTo">
					@{Html(messages.at("time.fromTo", """
					<div class="form-group"
						 ng-class="{'has-error':fromTo.from.$error.date||fromTo.from.$error.required}">
						<input type='date' class='form-control' ng-model='from' name="from" required
							   ng-model-options="{ updateOn: 'default blur', debounce: { default: 500, blur: 0 } }"
							   min="1000-01-01" max="3000-12-31">
					</div>
					""", """
					<div class="form-group" ng-class="{'has-error':fromTo.to.$error.date||fromTo.to.$error.required}">
						<input type='date' class='form-control' ng-model='to' name="to" required
							   ng-model-options="{ updateOn: 'default blur', debounce: { default: 500, blur: 0 } }"
							   min="1000-01-01" max="3000-12-31">
					</div>
					"""))}
					&nbsp;
					<span class="text-danger" ng-if="fromTo.from.$error.required||fromTo.to.$error.required">@messages.at("time.fromTo.required")</span>
					<span class="text-danger" ng-if="fromTo.from.$error.date||fromTo.to.$error.date">@messages.at("time.fromTo.date")</span>
					<span class="text-danger"
						  ng-if="fromTo.from.$error.min||fromTo.to.$error.min||fromTo.from.$error.max||fromTo.to.$error.max">@messages.at("time.fromTo.minmax")</span>
			</div>
			</form>
		</div>
	</div>
</div>
</div>

<div class="row fadeAnimation" ng-if="calendar">
	<div class="col-md-12">
		<div class="panel" ng-class="{true: 'panel-warning', false: 'panel-default'}[requestOngoing]">
			<div class="panel-heading">
				<h3 class="panel-title">@messages.at("calendar.title")<span ng-if="requestOngoing"> (@messages.at("calendar.reloading"))</span>
				</h3>
			</div>
			<table class="table table-bordered">
				<tr ng-repeat="event in calendar" class="fadeAnimation">
					<td>{{event.date| date:'mediumDate'}}</td>
					<td>{{event.title}}</td>
					<td class="text-muted description">{{event.description}}</td>
				</tr>
			</table>
		</div>
	</div>
</div>

<div class="row fadeAnimation" ng-if="error">
	<div class="col-md-12">
		<div class="panel panel-danger">
			<div class="panel-heading">
				<h3 class="panel-title">Fehler {{error.status}}: {{error.statusText}}</h3>
			</div>
			<div class="panel-body">
				{{error.data}}
			</div>
		</div>
	</div>
</div>

<div class="row">
	<div class="col-md-12">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">@messages.at("export.title")</h3>
			</div>
			<div class="panel-body">
				<div class="btn-group">
					<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"
							aria-expanded="false">@messages.at("export.ical")<span class="caret"></span>
					</button>
					<ul class="dropdown-menu" role="menu">
						<li><a href="" ng-click="downloadIcal()">@messages.at("export.ical.download")</a></li>
						<li><a href="" data-toggle="modal" data-target="#myModal" ng-click="trackIcalSubscription()">@messages.at("export.ical.subscribe")</a>
						</li>
					</ul>
				</div>
				<div class="btn-group" role="group" aria-label="...">
					<button type="button" class="btn btn-default" onclick="window.print()" ng-click="trackPrint()">@messages.at("export.print")
					</button>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
						aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="myModalLabel">@messages.at("export.ical.subscribe")</h4>
			</div>
			<div class="modal-body">
				<p>@messages.at("export.ical.subscribe.instructions"):</p>
				<p>
					<textarea type="text" class="form-control" readonly="readonly" rows="4">@controllers.routes.Application.queryAsICalendar(messages.at("lang.current")).absoluteURL(request)&phases[full]={{phases.full.value}}&phases[new]={{phases.new.value}}&phases[quarter]={{phases.quarter.value}}&phases[daily]={{phases.daily.value}}&events[lunareclipse]={{events.lunareclipse.value}}&events[solareclipse]={{events.solareclipse.value}}&events[moonlanding]={{events.moonlanding.value}}&before=P6M&after=P2Y&zone={{zone}}</textarea>
				</p>
				<p class="text-muted">@messages.at("export.ical.subscribe.explanations")</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">@messages.at("export.ical.subscribe.close")</button>
			</div>
		</div>
	</div>
</div>
<br/>
<br/>
